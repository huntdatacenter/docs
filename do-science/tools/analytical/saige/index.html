<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Saige</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="shortcut icon" href="https://www.ntnu.no/assets/images/favicon.ico">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:100,300,400,500,700,900|Material+Icons">
    <meta name="description" content="Installation guide for Saige">
    <meta property="og:title" content="Analytical tools: Saige">
    <meta property="og:description" content="Installation guide for Saige">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://docs.hdc.ntnu.no/do-science/tools/analytical/saige/">
    <meta name="twitter:title" content="Analytical tools: Saige">
    <meta name="twitter:description" content="Installation guide for Saige">
    <meta name="twitter:url" content="https://docs.hdc.ntnu.no/do-science/tools/analytical/saige/">
    <meta name="twitter:card" content="summary">
    <meta name="theme-color" content="#00509e">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    
    <link rel="preload" href="/assets/css/0.styles.8b202df8.css" as="style"><link rel="preload" href="/assets/js/app.eacf80d8.js" as="script"><link rel="preload" href="/assets/js/10.e3e5e53f.js" as="script"><link rel="preload" href="/assets/js/127.bf397f17.js" as="script"><link rel="prefetch" href="/assets/js/1.f64fa7a6.js"><link rel="prefetch" href="/assets/js/100.6f1fa48c.js"><link rel="prefetch" href="/assets/js/101.1f89f422.js"><link rel="prefetch" href="/assets/js/102.3059ad43.js"><link rel="prefetch" href="/assets/js/103.c42fce57.js"><link rel="prefetch" href="/assets/js/104.0834d98f.js"><link rel="prefetch" href="/assets/js/105.8a146c00.js"><link rel="prefetch" href="/assets/js/106.3ccf689a.js"><link rel="prefetch" href="/assets/js/107.91962a19.js"><link rel="prefetch" href="/assets/js/108.b1c2b831.js"><link rel="prefetch" href="/assets/js/109.92dc0b62.js"><link rel="prefetch" href="/assets/js/11.458b6eb2.js"><link rel="prefetch" href="/assets/js/110.1fafa2f6.js"><link rel="prefetch" href="/assets/js/111.62bd9cd1.js"><link rel="prefetch" href="/assets/js/112.c0f13743.js"><link rel="prefetch" href="/assets/js/113.00a401f8.js"><link rel="prefetch" href="/assets/js/114.6be47b84.js"><link rel="prefetch" href="/assets/js/115.67b2eedb.js"><link rel="prefetch" href="/assets/js/116.f1d143a1.js"><link rel="prefetch" href="/assets/js/117.e1a71267.js"><link rel="prefetch" href="/assets/js/118.8d382975.js"><link rel="prefetch" href="/assets/js/119.73c6f2e0.js"><link rel="prefetch" href="/assets/js/12.8d2c310d.js"><link rel="prefetch" href="/assets/js/120.8f0e06df.js"><link rel="prefetch" href="/assets/js/121.748a6f67.js"><link rel="prefetch" href="/assets/js/122.4e7a4484.js"><link rel="prefetch" href="/assets/js/123.983b54d5.js"><link rel="prefetch" href="/assets/js/124.9b1b0ff3.js"><link rel="prefetch" href="/assets/js/125.522ee08e.js"><link rel="prefetch" href="/assets/js/126.213db53b.js"><link rel="prefetch" href="/assets/js/128.7c28c578.js"><link rel="prefetch" href="/assets/js/129.6c9f700f.js"><link rel="prefetch" href="/assets/js/13.d9ce64b6.js"><link rel="prefetch" href="/assets/js/130.62ac24fd.js"><link rel="prefetch" href="/assets/js/131.0d41c81d.js"><link rel="prefetch" href="/assets/js/132.7fabaa96.js"><link rel="prefetch" href="/assets/js/133.148548a7.js"><link rel="prefetch" href="/assets/js/134.0dc21de6.js"><link rel="prefetch" href="/assets/js/135.5a90700d.js"><link rel="prefetch" href="/assets/js/136.98eb9e39.js"><link rel="prefetch" href="/assets/js/137.9887a478.js"><link rel="prefetch" href="/assets/js/138.8fd0c7a8.js"><link rel="prefetch" href="/assets/js/139.ed8380cf.js"><link rel="prefetch" href="/assets/js/14.bceaad38.js"><link rel="prefetch" href="/assets/js/140.cf0ce353.js"><link rel="prefetch" href="/assets/js/141.339539cc.js"><link rel="prefetch" href="/assets/js/142.cbf788e6.js"><link rel="prefetch" href="/assets/js/143.a63cd0c7.js"><link rel="prefetch" href="/assets/js/144.07113729.js"><link rel="prefetch" href="/assets/js/145.1ad67872.js"><link rel="prefetch" href="/assets/js/146.039d105b.js"><link rel="prefetch" href="/assets/js/147.4211f683.js"><link rel="prefetch" href="/assets/js/148.6c9a708b.js"><link rel="prefetch" href="/assets/js/149.3e255d8c.js"><link rel="prefetch" href="/assets/js/15.10b123b6.js"><link rel="prefetch" href="/assets/js/150.f1496643.js"><link rel="prefetch" href="/assets/js/151.0c5fa401.js"><link rel="prefetch" href="/assets/js/152.b68eaec2.js"><link rel="prefetch" href="/assets/js/153.16c77eb0.js"><link rel="prefetch" href="/assets/js/154.55935262.js"><link rel="prefetch" href="/assets/js/155.cf21af39.js"><link rel="prefetch" href="/assets/js/156.f6726e79.js"><link rel="prefetch" href="/assets/js/157.cc1a1387.js"><link rel="prefetch" href="/assets/js/158.0b5e31d5.js"><link rel="prefetch" href="/assets/js/159.c489e74b.js"><link rel="prefetch" href="/assets/js/16.c7344cfd.js"><link rel="prefetch" href="/assets/js/160.53df7591.js"><link rel="prefetch" href="/assets/js/161.8bd0ae01.js"><link rel="prefetch" href="/assets/js/162.cdd98f63.js"><link rel="prefetch" href="/assets/js/163.763d51ea.js"><link rel="prefetch" href="/assets/js/164.32c6a58b.js"><link rel="prefetch" href="/assets/js/165.10cf7503.js"><link rel="prefetch" href="/assets/js/166.140f7611.js"><link rel="prefetch" href="/assets/js/17.8138ec95.js"><link rel="prefetch" href="/assets/js/18.1e8b2e58.js"><link rel="prefetch" href="/assets/js/19.a54246db.js"><link rel="prefetch" href="/assets/js/2.81ae5f81.js"><link rel="prefetch" href="/assets/js/20.8b67b003.js"><link rel="prefetch" href="/assets/js/21.090299e1.js"><link rel="prefetch" href="/assets/js/22.a01f6e6b.js"><link rel="prefetch" href="/assets/js/23.67a2a504.js"><link rel="prefetch" href="/assets/js/24.2ef79e31.js"><link rel="prefetch" href="/assets/js/25.8075c75e.js"><link rel="prefetch" href="/assets/js/26.f0ca5bbc.js"><link rel="prefetch" href="/assets/js/27.5b626f8c.js"><link rel="prefetch" href="/assets/js/28.d7eeec07.js"><link rel="prefetch" href="/assets/js/29.c01a8397.js"><link rel="prefetch" href="/assets/js/3.8c4a6202.js"><link rel="prefetch" href="/assets/js/30.0e79f85f.js"><link rel="prefetch" href="/assets/js/31.781a1d5e.js"><link rel="prefetch" href="/assets/js/32.f1f95b70.js"><link rel="prefetch" href="/assets/js/33.3dfd132a.js"><link rel="prefetch" href="/assets/js/34.cd731d89.js"><link rel="prefetch" href="/assets/js/35.49b80938.js"><link rel="prefetch" href="/assets/js/36.02c8d49e.js"><link rel="prefetch" href="/assets/js/37.1c69ee41.js"><link rel="prefetch" href="/assets/js/38.4b5b367a.js"><link rel="prefetch" href="/assets/js/39.58c54fc3.js"><link rel="prefetch" href="/assets/js/4.6674389e.js"><link rel="prefetch" href="/assets/js/40.68f71f66.js"><link rel="prefetch" href="/assets/js/41.1e7f9b9b.js"><link rel="prefetch" href="/assets/js/42.13b99c0f.js"><link rel="prefetch" href="/assets/js/43.63f738c1.js"><link rel="prefetch" href="/assets/js/44.2166c653.js"><link rel="prefetch" href="/assets/js/45.e81a50d6.js"><link rel="prefetch" href="/assets/js/46.2e008bf7.js"><link rel="prefetch" href="/assets/js/47.d943bd14.js"><link rel="prefetch" href="/assets/js/48.ee9ccf07.js"><link rel="prefetch" href="/assets/js/49.1e4c74c0.js"><link rel="prefetch" href="/assets/js/5.170b5189.js"><link rel="prefetch" href="/assets/js/50.9b94d885.js"><link rel="prefetch" href="/assets/js/51.a0c31f15.js"><link rel="prefetch" href="/assets/js/52.9a1fa36f.js"><link rel="prefetch" href="/assets/js/53.7c486052.js"><link rel="prefetch" href="/assets/js/54.dc1cdf76.js"><link rel="prefetch" href="/assets/js/55.bf271c7c.js"><link rel="prefetch" href="/assets/js/56.f364b67c.js"><link rel="prefetch" href="/assets/js/57.fd2c4c8a.js"><link rel="prefetch" href="/assets/js/58.d765081c.js"><link rel="prefetch" href="/assets/js/59.26d8c87c.js"><link rel="prefetch" href="/assets/js/6.7c97c9b2.js"><link rel="prefetch" href="/assets/js/60.965edbd2.js"><link rel="prefetch" href="/assets/js/61.7fd54b3e.js"><link rel="prefetch" href="/assets/js/62.b932b4bd.js"><link rel="prefetch" href="/assets/js/63.e63b3da0.js"><link rel="prefetch" href="/assets/js/64.450eb5ab.js"><link rel="prefetch" href="/assets/js/65.d7c907ba.js"><link rel="prefetch" href="/assets/js/66.bfcbd24f.js"><link rel="prefetch" href="/assets/js/67.7c63f83f.js"><link rel="prefetch" href="/assets/js/68.1389eb77.js"><link rel="prefetch" href="/assets/js/69.f3108b94.js"><link rel="prefetch" href="/assets/js/7.c361415c.js"><link rel="prefetch" href="/assets/js/70.f2a82353.js"><link rel="prefetch" href="/assets/js/71.a228e3c0.js"><link rel="prefetch" href="/assets/js/72.8c8080b9.js"><link rel="prefetch" href="/assets/js/73.a4985d34.js"><link rel="prefetch" href="/assets/js/74.616b900c.js"><link rel="prefetch" href="/assets/js/75.7780aa08.js"><link rel="prefetch" href="/assets/js/76.da647c34.js"><link rel="prefetch" href="/assets/js/77.be95db11.js"><link rel="prefetch" href="/assets/js/78.093978b5.js"><link rel="prefetch" href="/assets/js/79.62cd93b8.js"><link rel="prefetch" href="/assets/js/8.07acd8ed.js"><link rel="prefetch" href="/assets/js/80.0cf70f5f.js"><link rel="prefetch" href="/assets/js/81.ccb020a9.js"><link rel="prefetch" href="/assets/js/82.c6f1d377.js"><link rel="prefetch" href="/assets/js/83.ce2b621b.js"><link rel="prefetch" href="/assets/js/84.b3b10770.js"><link rel="prefetch" href="/assets/js/85.0e959dcc.js"><link rel="prefetch" href="/assets/js/86.9d77c157.js"><link rel="prefetch" href="/assets/js/87.1f6a87fa.js"><link rel="prefetch" href="/assets/js/88.aabebff2.js"><link rel="prefetch" href="/assets/js/89.97f0ceb3.js"><link rel="prefetch" href="/assets/js/90.0d1c440c.js"><link rel="prefetch" href="/assets/js/91.5307dc3d.js"><link rel="prefetch" href="/assets/js/92.61dbb6af.js"><link rel="prefetch" href="/assets/js/93.6cc39a96.js"><link rel="prefetch" href="/assets/js/94.0664898d.js"><link rel="prefetch" href="/assets/js/95.ccbd86ce.js"><link rel="prefetch" href="/assets/js/96.1d61ba45.js"><link rel="prefetch" href="/assets/js/97.ed9a3d48.js"><link rel="prefetch" href="/assets/js/98.d4b0c165.js"><link rel="prefetch" href="/assets/js/99.78221bab.js">
    <link rel="stylesheet" href="/assets/css/0.styles.8b202df8.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/img/hunt-cloud-logo.svg" alt="" class="logo"> <!----></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/do-science/" class="nav-link router-link-active">
  Do science
</a></div><div class="nav-item"><a href="/administer-science/" class="nav-link">
  Administer science
</a></div><div class="nav-item"><a href="/govern-science/" class="nav-link">
  Govern science
</a></div><div class="nav-item"><a href="/about/" class="nav-link">
  About
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/do-science/" class="nav-link router-link-active">
  Do science
</a></div><div class="nav-item"><a href="/administer-science/" class="nav-link">
  Administer science
</a></div><div class="nav-item"><a href="/govern-science/" class="nav-link">
  Govern science
</a></div><div class="nav-item"><a href="/about/" class="nav-link">
  About
</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Do science</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/do-science/" aria-current="page" class="sidebar-link">Welcome</a></li><li><a href="/do-science/system-status/" class="sidebar-link">System status</a></li><li><a href="/do-science/contact/" class="sidebar-link">Contact</a></li><li><a href="/do-science/contribute/" class="sidebar-link">Contribute</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Lab access</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>HUNT Workbench</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Tools</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/do-science/tools/" aria-current="page" class="sidebar-link">Introduction</a></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>Technical tools</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading open"><span>Analytical tools</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/do-science/tools/analytical/bluebox/" class="sidebar-link">BlueBox</a></li><li><a href="/do-science/tools/analytical/conda/" class="sidebar-link">Conda</a></li><li><a href="/do-science/tools/analytical/epacts/" class="sidebar-link">EPACTS</a></li><li><a href="/do-science/tools/analytical/fsl/" class="sidebar-link">FSL</a></li><li><a href="/do-science/tools/analytical/freesurfer/" class="sidebar-link">Freesurfer</a></li><li><a href="/do-science/tools/analytical/jupyter-lab/" class="sidebar-link">JupyterLab</a></li><li><a href="/do-science/tools/analytical/MATLAB/" class="sidebar-link">MATLAB</a></li><li><a href="/do-science/tools/analytical/plink/" class="sidebar-link">PLINK</a></li><li><a href="/do-science/tools/analytical/pycharm/" class="sidebar-link">PyCharm</a></li><li><a href="/do-science/tools/analytical/r-studio/" class="sidebar-link">R and R-Studio</a></li><li><a href="/do-science/tools/analytical/regenie/" class="sidebar-link">Regenie</a></li><li><a href="/do-science/tools/analytical/saige/" aria-current="page" class="active sidebar-link">Saige</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/do-science/tools/analytical/saige/#install-using-conda" class="sidebar-link">Install using conda</a></li><li class="sidebar-sub-header"><a href="/do-science/tools/analytical/saige/#install-the-hard-way" class="sidebar-link">Install the hard way</a></li></ul></li><li><a href="/do-science/tools/analytical/spyder-ide/" class="sidebar-link">Spyder IDE</a></li><li><a href="/do-science/tools/analytical/stata/" class="sidebar-link">Stata</a></li></ul></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>Transfer tools</span> <span class="arrow right"></span></p> <!----></section></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Guides</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Data transfers</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Community</span> <span class="arrow right"></span></p> <!----></section></li><li><a href="/do-science/service-desk/" class="sidebar-link">Service desk</a></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Troubleshooting</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>FAQ</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="saige-package-for-r"><a href="#saige-package-for-r" class="header-anchor">#</a> Saige package for R</h1> <p><strong><a href="https://github.com/weizhouUMICH/SAIGE" target="_blank" rel="noopener noreferrer">SAIGE is an R package<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> with Scalable and Accurate Implementation of Generalized mixed model (Chen, H. et al. 2016). It accounts for sample relatedness and is feasible for genetic association tests in large cohorts and biobanks.</strong></p> <p></p><div class="table-of-contents"><ul><li><a href="#install-using-conda">Install using conda</a></li><li><a href="#install-the-hard-way">Install the hard way</a><ul><li><a href="#defining-your-software-directory">Defining your software directory</a></li><li><a href="#install-required-apt-packages">Install required APT packages</a></li><li><a href="#defining-your-java-version">Defining your Java version</a></li><li><a href="#installing-required-python-packages">Installing required python packages</a></li><li><a href="#installing-a-specific-r-version">Installing a specific R version</a></li><li><a href="#installing-saige">Installing SAIGE</a></li><li><a href="#set-number-of-threads-for-openblas">Set number of threads for openblas</a></li><li><a href="#combine">Combine</a></li><li><a href="#cleanup">Cleanup</a></li><li><a href="#testing-saige">Testing SAIGE</a></li></ul></li></ul></div><p></p> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>If you are interested in using Saige, you should try to <a href="/do-science/tools/analytical/regenie/">Regenie</a>, a strong C++ tool for whole genome regression modelling of large GWAS.</p></div> <h2 id="install-using-conda"><a href="#install-using-conda" class="header-anchor">#</a> Install using conda</h2> <div class="custom-block warning"><p class="custom-block-title">Requirements</p> <ul><li>Conda (miniconda), see our <a href="/do-science/tools/analytical/conda/">Conda tutorial</a> for more details.</li> <li>Conda channels: conda-forge, bioconda</li></ul></div> <p>You will need bioconda and conda-forge channels. If you have not set channels yet
make sure to add them in this order:</p> <div class="language- extra-class"><pre class="language-text"><code>conda config --add channels bioconda
conda config --add channels conda-forge
</code></pre></div><p>To create a new environment and install the latest version of SAIGE use:</p> <div class="language- extra-class"><pre class="language-text"><code>conda create -n saige -c bioconda r-saige=0.44.2
conda activate saige
</code></pre></div><p>After installation you should be able to import SAIGE library in R and run SAIGE scripts:</p> <div class="language- extra-class"><pre class="language-text"><code>step1_fitNULLGLMM.R --help
step2_SPAtests.R --help
createSparseGRM.R --help
</code></pre></div><p>If you need to run your scripts with older version of R, you can use <code>3.6.3</code>:</p> <div class="language- extra-class"><pre class="language-text"><code>conda install -c conda-forge -c bioconda &quot;r-base=3.6.3&quot; r-saige
</code></pre></div><h2 id="install-the-hard-way"><a href="#install-the-hard-way" class="header-anchor">#</a> Install the hard way</h2> <p>The below guide is based on packages listed in the Dockerfile example in Github. It describes installation
of the <a href="https://github.com/weizhouUMICH/SAIGE" target="_blank" rel="noopener noreferrer">SAIGE R package<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> on a clean IAAS or BLUE machine in HUNT Cloud.</p> <div class="custom-block warning"><p class="custom-block-title">Requirements</p> <ul><li>Ubuntu operating system (current installation is tested on 18.04).</li> <li>Administrator privileges (HUNT IAAS or HUNT BLUE machines).</li> <li>Fresh coffee and 30 minutes to spare.</li></ul></div> <h3 id="defining-your-software-directory"><a href="#defining-your-software-directory" class="header-anchor">#</a> Defining your software directory</h3> <p>Below is an example:</p> <div class="language- extra-class"><pre class="language-text"><code># Define your software directory
software_dir=&quot;/home/ubuntu/software/&quot;

# Create directory if it don't exist
mkdir -p $software_dir

# Move into the directory
cd $software_dir
</code></pre></div><h3 id="install-required-apt-packages"><a href="#install-required-apt-packages" class="header-anchor">#</a> Install required APT packages</h3> <div class="language- extra-class"><pre class="language-text"><code>sudo apt update -y &amp;&amp; sudo apt-get install -y \
    build-essential \
    cmake \
    curl \
    libboost-all-dev \
    libbz2-dev \
    libcairo2-dev \
    libcurl4-openssl-dev \
    liblzma-dev \
    libopenblas-dev \
    libpcre3-dev \
    libpng-dev \
    libreadline-dev \
    libssl-dev \
    libz-dev \
    python3-pip \
    python3-setuptools \
    unzip \
    gfortran \
    r-cran-rjava \
    openjdk-8-jdk
</code></pre></div><h3 id="defining-your-java-version"><a href="#defining-your-java-version" class="header-anchor">#</a> Defining your Java version</h3> <p>Run the code below and manually choose java-8in the provided list and hit 'ENTER'.</p> <div class="language- extra-class"><pre class="language-text"><code># manual update to java-8-openjdk
sudo update-alternatives --config java
</code></pre></div><h3 id="installing-required-python-packages"><a href="#installing-required-python-packages" class="header-anchor">#</a> Installing required python packages</h3> <div class="language- extra-class"><pre class="language-text"><code>pip3 install cget;
</code></pre></div><h3 id="installing-a-specific-r-version"><a href="#installing-a-specific-r-version" class="header-anchor">#</a> Installing a specific R version</h3> <p>The current SAIGE version requires a specific R-version (3.5.1). The below snippets compile this specific version.</p> <div class="language- extra-class"><pre class="language-text"><code># ensure software dir
cd $software_dir

# define version
r_version=&quot;3.5.1&quot;;

# download
curl -O https://cloud.r-project.org/src/base/R-3/R-${r_version}.tar.gz;

# unzip
tar xvzf R-${r_version}.tar.gz;

# cleanup
rm R-${r_version}.tar.gz;

# move into r-folder
cd $software_dir/R-${r_version}

# configure
sudo ./configure \
  --with-x=no \
  --with-blas=&quot;-lopenblas&quot; \
  --enable-R-shlib  \
  -enable-shared;

# make
sudo make; # TODO stopped here
sudo mkdir -p /usr/local/lib/R/lib;

# install
sudo make install;

# cleanup
cd $software_dir
sudo rm -rf $software_dir/R-${r_version}
</code></pre></div><h3 id="installing-saige"><a href="#installing-saige" class="header-anchor">#</a> Installing SAIGE</h3> <div class="language- extra-class"><pre class="language-text"><code>cd $software_dir

# Download latest version
curl -OL https://github.com/weizhouUMICH/SAIGE/archive/master.zip

# Unpack
unzip master.zip

# Update file folder names
mv SAIGE-master/ SAIGE/

# Install required R-packages
Rscript SAIGE/extdata/install_packages.R

# Install SAIGE
R CMD INSTALL SAIGE
</code></pre></div><h3 id="set-number-of-threads-for-openblas"><a href="#set-number-of-threads-for-openblas" class="header-anchor">#</a> Set number of threads for openblas</h3> <p>This steps adds a thread restriction on BLAS to avoid multithread
conflicts with other R packages.</p> <p>First, add restriction to <code>step2_SPAtests.R</code></p> <div class="language- extra-class"><pre class="language-text"><code>echo &quot;#!/usr/bin/env Rscript

# Restrict threads in openblas
hasOpenBlas = grepl(\&quot;openblas\&quot;,extSoftVersion()[\&quot;BLAS\&quot;]);
if (hasOpenBlas) {
  ### Only when using openblas instead of blas
  require(inline)
  openblas.set.num.threads &lt;- cfunction( signature(ipt=\&quot;integer\&quot;),
    body = \'openblas_set_num_threads(*ipt);\',
    otherdefs = c (\'extern void openblas_set_num_threads(int);\'),
      libargs = c (\'-L/opt/openblas/lib -lopenblas\'),
      language = \&quot;C\&quot;,
      convention = \&quot;.C\&quot;)};
if (hasOpenBlas) openblas.set.num.threads(1)
&quot; &gt; insert_openblas_restriction.tmp
</code></pre></div><p>Then, add to file:</p> <div class="language- extra-class"><pre class="language-text"><code># cut header
cat SAIGE/extdata/step2_SPAtests.R | sed -n '1!p' &gt; step2_body.tmp
</code></pre></div><h3 id="combine"><a href="#combine" class="header-anchor">#</a> Combine</h3> <div class="language- extra-class"><pre class="language-text"><code>cat insert_openblas_restriction.tmp \
    step2_body.tmp &gt; step2_SPAtests.R
Install the required 'inline' R-package:
echo 'req_packages &lt;- &quot;inline&quot;;
for (pack in req_packages) {
  if(!require(pack,character.only = TRUE)) {
    install.packages(pack, repos = &quot;http://cran.us.r-project.org&quot;)}}' \
&gt; install_inline.R
Rscript install_inline.R
rm install_inline.R
</code></pre></div><p>Add quick references:</p> <div class="language- extra-class"><pre class="language-text"><code># Move files to usr/local/bin for quick referencing
sudo mv SAIGE/extdata/step1_fitNULLGLMM.R /usr/local/bin/
sudo mv step2_SPAtests.R /usr/local/bin/
sudo mv SAIGE/extdata/createSparseGRM.R /usr/local/bin/
sudo chmod a+x /usr/local/bin/*.R
</code></pre></div><h3 id="cleanup"><a href="#cleanup" class="header-anchor">#</a> Cleanup</h3> <div class="language- extra-class"><pre class="language-text"><code>rm -rf master.zip
rm -rf SAIGE
rm insert_openblas_restriction.tmp
rm step2_body.tmp
rm step2_SPAtests.R
</code></pre></div><h3 id="testing-saige"><a href="#testing-saige" class="header-anchor">#</a> Testing SAIGE</h3> <div class="language- extra-class"><pre class="language-text"><code>step1_fitNULLGLMM.R

step2_SPAtests.R

createSparseGRM.R
</code></pre></div><p>More information</p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">6/20/2023</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/do-science/tools/analytical/regenie/" class="prev">
        Regenie
      </a></span> <span class="next"><a href="/do-science/tools/analytical/spyder-ide/">
        Spyder IDE
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.eacf80d8.js" defer></script><script src="/assets/js/10.e3e5e53f.js" defer></script><script src="/assets/js/127.bf397f17.js" defer></script>
  </body>
</html>
