(window.webpackJsonp=window.webpackJsonp||[]).push([[198],{1237:function(s,t,a){"use strict";a.r(t);var e=a(41),n=Object(e.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"docker"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker"}},[s._v("#")]),s._v(" Docker")]),s._v(" "),a("p",[a("strong",[a("a",{attrs:{href:"https://docs.docker.com/engine/install/ubuntu/",target:"_blank",rel:"noopener noreferrer"}},[s._v("Docker"),a("OutboundLink")],1),s._v(" provides application containers for Linux. You may run Docker on On-demand and BLUE machines.")])]),s._v(" "),a("p"),a("div",{staticClass:"table-of-contents"},[a("ul",[a("li",[a("a",{attrs:{href:"#installation"}},[s._v("Installation")])]),a("li",[a("a",{attrs:{href:"#move-docker-directory"}},[s._v("Move Docker directory")])]),a("li",[a("a",{attrs:{href:"#troubleshooting"}},[s._v("Troubleshooting")]),a("ul",[a("li",[a("a",{attrs:{href:"#issues-with-pip-packages"}},[s._v("Issues with pip packages")])])])])])]),a("p"),s._v(" "),a("div",{staticClass:"custom-block warning"},[a("p",{staticClass:"custom-block-title"},[s._v("Singularity on home machines")]),s._v(" "),a("p",[s._v("Docker will fail on your "),a("strong",[a("code",[s._v("home")])]),s._v(" machine due to security restrictions. We recommend that you run Singularity on your home machine. Read more in our "),a("RouterLink",{attrs:{to:"/do-science/tools/technical/singularity/"}},[s._v("Singularity installation guide")]),s._v(".")],1)]),s._v(" "),a("h2",{attrs:{id:"installation"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#installation"}},[s._v("#")]),s._v(" Installation")]),s._v(" "),a("p",[s._v("Follow the official "),a("a",{attrs:{href:"https://docs.docker.com/engine/install/ubuntu/",target:"_blank",rel:"noopener noreferrer"}},[s._v("Docker installation guide"),a("OutboundLink")],1),s._v(" to install Docker on unmanaged machines (On-demand and BLUE machines). "),a("RouterLink",{attrs:{to:"/do-science/tools/technical/gpu/"}},[s._v("GPU machines")]),s._v(" come with nvidia-docker preinstalled.")],1),s._v(" "),a("h2",{attrs:{id:"move-docker-directory"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#move-docker-directory"}},[s._v("#")]),s._v(" Move Docker directory")]),s._v(" "),a("p",[s._v("The operating system volume on your machine is limited in size. Depending on your size requirements, you may want to move your docker directory off the system disk and over to your machine home folder.")]),s._v(" "),a("p",[s._v("On you unamanged machine:")]),s._v(" "),a("ol",[a("li",[s._v("Stop the docker service.")])]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("service")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" stop\n")])])]),a("ol",{attrs:{start:"2"}},[a("li",[s._v("Copy your Docker files to your home folder.")])]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("rsync")]),s._v(" -avu /var/lib/docker/ /home/docker\n")])])]),a("ol",{attrs:{start:"3"}},[a("li",[s._v("Point Docker to your new location by editing "),a("strong",[a("code",[s._v("/etc/docker/daemon.json")])]),s._v(" and add your new "),a("strong",[a("code",[s._v("data-root")])]),s._v(" path:")])]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v(" /etc/docker/daemon.json\n")])])]),a("p",[s._v("Example for On-demand and BLUE machines:")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"data-root"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/home/docker"')]),s._v(",\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])]),a("p",[s._v("Example for GPU machines:")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"data-root"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/home/docker"')]),s._v(",\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"runtimes"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"nvidia"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"path"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"nvidia-container-runtime"')]),s._v(",\n            "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"runtimeArgs"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])]),a("ol",{attrs:{start:"4"}},[a("li",[s._v("Backup your original Docker files.")])]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mv")]),s._v(" /var/lib/docker /var/lib/docker.backup\n")])])]),a("ol",{attrs:{start:"5"}},[a("li",[s._v("Restart the Docker service to fetch the new location.")])]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("service")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" restart\n")])])]),a("ol",{attrs:{start:"6"}},[a("li",[s._v("Test your new setup with a Docker command.")])]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ps")]),s._v(" -a\n")])])]),a("h2",{attrs:{id:"troubleshooting"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#troubleshooting"}},[s._v("#")]),s._v(" Troubleshooting")]),s._v(" "),a("h3",{attrs:{id:"issues-with-pip-packages"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#issues-with-pip-packages"}},[s._v("#")]),s._v(" Issues with pip packages")]),s._v(" "),a("p",[s._v("We have seen issues with installation of pip packages due to "),a("strong",[a("code",[s._v("mtu")])]),s._v(" size issues. One solution is to add "),a("strong",[a("code",[s._v("mtu")])]),s._v(" size specification to your Docker config file:")]),s._v(" "),a("ol",[a("li",[s._v("Open your Docker config file.")])]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v(" /etc/docker/daemon.json\n")])])]),a("ol",{attrs:{start:"2"}},[a("li",[s._v("Set "),a("strong",[a("code",[s._v("mtu")])]),s._v(" to 1330.")])]),s._v(" "),a("p",[s._v("This is an example configuration setting "),a("strong",[a("code",[s._v("mtu")])]),s._v(" to 1330 to avoid most issues with packet sizes:")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"data-root"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/home/docker"')]),s._v(",\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"mtu"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1330")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])])])}),[],!1,null,null,null);t.default=n.exports}}]);